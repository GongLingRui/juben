# æ¥å£æ–‡æ¡£

## æ¥å£æ¦‚è¿°

å‰§æœ¬åˆ›ä½œ Agent å¹³å°æä¾›RESTful APIæ¥å£ï¼Œæ”¯æŒæµå¼å“åº”ï¼ˆSSEï¼‰ï¼Œæ‰€æœ‰æ¥å£ä½¿ç”¨UTF-8ç¼–ç ï¼Œè¿”å›JSONæ ¼å¼æ•°æ®ã€‚

**åŸºç¡€URL**: `http://localhost:8000`

**APIç‰ˆæœ¬**: v1.0.0

## ç›®å½•

- [é€šç”¨è¯´æ˜](#é€šç”¨è¯´æ˜)
- [Agentç®¡ç†æ¥å£](#agentç®¡ç†æ¥å£)
- [èŠå¤©äº¤äº’æ¥å£](#èŠå¤©äº¤äº’æ¥å£)
- [é¡¹ç›®ç®¡ç†æ¥å£](#é¡¹ç›®ç®¡ç†æ¥å£)
- [å·¥å…·ç±»æ¥å£](#å·¥å…·ç±»æ¥å£)
- [çŸ¥è¯†åº“æ¥å£](#çŸ¥è¯†åº“æ¥å£)
- [ç³»ç»Ÿæ¥å£](#ç³»ç»Ÿæ¥å£)

## é€šç”¨è¯´æ˜

### è¯·æ±‚å¤´

| è¯·æ±‚å¤´ | å€¼ | å¿…å¡« | è¯´æ˜ |
|--------|-----|------|------|
| Content-Type | application/json | æ˜¯ | è¯·æ±‚å†…å®¹ç±»å‹ |
| Accept | text/event-stream | æ¡ä»¶å¿…å¡« | æµå¼å“åº”æ—¶å¿…å¡« |

### å“åº”ç 

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

### åŸºç¡€å“åº”æ¨¡å‹

```typescript
interface BaseResponse {
  success: boolean;        // è¯·æ±‚æ˜¯å¦æˆåŠŸ
  message: string;         // å“åº”æ¶ˆæ¯
  data?: any;             // å“åº”æ•°æ®
  timestamp: string;       // æ—¶é—´æˆ³
}
```

### é”™è¯¯å“åº”æ¨¡å‹

```typescript
interface ErrorResponse {
  success: false;
  message: string;
  error_code?: string;     // é”™è¯¯ä»£ç 
  detail?: string;         // é”™è¯¯è¯¦æƒ…
  timestamp: string;
}
```

## Agentç®¡ç†æ¥å£

### 1. è·å–Agentåˆ—è¡¨

**æ¥å£**: `GET /juben/agents/list`

**æè¿°**: è·å–æ‰€æœ‰å¯ç”¨çš„Agentsåˆ—è¡¨

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| category | string | å¦ | æŒ‰åˆ†ç±»ç­›é€‰ |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /juben/agents/list?category=planning
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "agents": [
    {
      "id": "short_drama_planner",
      "name": "ShortDramaPlannerAgent",
      "display_name": "çŸ­å‰§ç­–åˆ’åŠ©æ‰‹",
      "description": "ä¸“ä¸šçš„çŸ­å‰§ç­–åˆ’å’Œåˆ›ä½œå»ºè®®åŠ©æ‰‹",
      "category": "planning",
      "icon": "ğŸ“‹",
      "model": "glm-4-flash",
      "api_endpoint": "/juben/chat",
      "features": ["å‰§æœ¬ç­–åˆ’", "æƒ…èŠ‚è®¾è®¡å»ºè®®", "ç»“æ„ä¼˜åŒ–", "åˆ›ä½œæŒ‡å¯¼"],
      "capabilities": ["åˆ†æå‰§æœ¬éœ€æ±‚å¹¶æä¾›ä¸“ä¸šç­–åˆ’å»ºè®®"],
      "status": "active"
    }
  ],
  "total": 1,
  "category_counts": {
    "planning": 1,
    "creation": 2,
    "evaluation": 8
  }
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:498-530`

### 2. è·å–Agentè¯¦æƒ…

**æ¥å£**: `GET /juben/agents/{agent_id}`

**æè¿°**: è·å–æŒ‡å®šAgentçš„è¯¦ç»†ä¿¡æ¯

**è·¯å¾„å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| agent_id | string | æ˜¯ | Agent ID |

**è¯·æ±‚ç¤ºä¾‹**:
```http
GET /juben/agents/short_drama_planner
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "agent": {
    "id": "short_drama_planner",
    "name": "ShortDramaPlannerAgent",
    "display_name": "çŸ­å‰§ç­–åˆ’åŠ©æ‰‹",
    "description": "ä¸“ä¸šçš„çŸ­å‰§ç­–åˆ’å’Œåˆ›ä½œå»ºè®®åŠ©æ‰‹",
    "category": "planning",
    "icon": "ğŸ“‹",
    "model": "glm-4-flash",
    "api_endpoint": "/juben/chat",
    "features": ["å‰§æœ¬ç­–åˆ’", "æƒ…èŠ‚è®¾è®¡å»ºè®®"],
    "status": "active"
  }
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:533-558`

### 3. è·å–Agentåˆ†ç±»

**æ¥å£**: `GET /juben/agents/categories`

**æè¿°**: è·å–æ‰€æœ‰Agentåˆ†ç±»

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "categories": {
    "planning": {"name": "ç­–åˆ’ç±»", "icon": "ğŸ“‹"},
    "creation": {"name": "åˆ›ä½œç±»", "icon": "âœï¸"},
    "evaluation": {"name": "è¯„ä¼°ç±»", "icon": "ğŸ“Š"},
    "analysis": {"name": "åˆ†æç±»", "icon": "ğŸ”"},
    "workflow": {"name": "å·¥ä½œæµ", "icon": "ğŸ”„"},
    "character": {"name": "äººç‰©ç±»", "icon": "ğŸ‘¤"},
    "story": {"name": "æ•…äº‹ç±»", "icon": "ğŸ“–"},
    "utility": {"name": "å·¥å…·ç±»", "icon": "ğŸ› ï¸"}
  },
  "counts": {
    "planning": 1,
    "creation": 1,
    "evaluation": 8
  },
  "total": 35
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:561-584`

### 4. æœç´¢Agent

**æ¥å£**: `GET /juben/agents/search`

**æè¿°**: æœç´¢Agents

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| query | string | æ˜¯ | æœç´¢å…³é”®è¯ |

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "results": [
    {
      "id": "short_drama_planner",
      "name": "ShortDramaPlannerAgent",
      "display_name": "çŸ­å‰§ç­–åˆ’åŠ©æ‰‹",
      "relevance_score": 0.95
    }
  ],
  "total": 1
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:587-610`

## èŠå¤©äº¤äº’æ¥å£

### 1. ä¸»èŠå¤©æ¥å£

**æ¥å£**: `POST /juben/chat`

**æè¿°**: ä¸çŸ­å‰§ç­–åˆ’åŠ©æ‰‹è¿›è¡Œå¯¹è¯ï¼ˆæ”¯æŒæµå¼å“åº”ï¼‰

**è¯·æ±‚ä½“**:

```typescript
interface ChatRequest {
  input: string;                    // ç”¨æˆ·è¾“å…¥ï¼ˆå¿…å¡«ï¼‰
  user_id?: string;                 // ç”¨æˆ·IDï¼ˆé»˜è®¤: default_userï¼‰
  session_id?: string;              // ä¼šè¯ID
  model_provider?: string;          // æ¨¡å‹æä¾›å•†
  model?: string;                   // æ¨¡å‹åç§°
  agent_id?: string;                // Agent ID
  history?: Array<{                 // å†å²å¯¹è¯
    role: string;
    content: string;
  }>;
  enable_web_search?: boolean;      // æ˜¯å¦å¯ç”¨ç½‘ç»œæœç´¢ï¼ˆé»˜è®¤: trueï¼‰
  enable_knowledge_base?: boolean;  // æ˜¯å¦å¯ç”¨çŸ¥è¯†åº“ï¼ˆé»˜è®¤: trueï¼‰
  count?: number;                   // æœç´¢ç»“æœæ•°é‡ï¼ˆé»˜è®¤: 5ï¼‰
  collection?: string;              // çŸ¥è¯†åº“é›†åˆï¼ˆé»˜è®¤: script_segmentsï¼‰
  top_k?: number;                   // çŸ¥è¯†åº“æ£€ç´¢æ•°é‡ï¼ˆé»˜è®¤: 5ï¼‰
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "input": "å¸®æˆ‘ç­–åˆ’ä¸€ä¸ªç°ä»£éƒ½å¸‚ç”œå® çŸ­å‰§",
  "user_id": "user123",
  "enable_web_search": true,
  "enable_knowledge_base": true
}
```

**æµå¼å“åº”äº‹ä»¶**:

```typescript
// æ¶ˆæ¯äº‹ä»¶
interface MessageEvent {
  type: "message";
  content: string;
  content_type: "text" | "markdown" | "json" | "html";
  timestamp: string;
}

// æ€è€ƒäº‹ä»¶
interface ThoughtEvent {
  type: "thought";
  content: string;
  step_number: number;
  timestamp: string;
}

// å·¥å…·è°ƒç”¨äº‹ä»¶
interface ToolEvent {
  type: "tool";
  tool_name: string;
  input: any;
  output: any;
  timestamp: string;
}

// å®Œæˆäº‹ä»¶
interface DoneEvent {
  type: "done";
  agent_name: string;
  token_usage?: {
    prompt_tokens: number;
    completion_tokens: number;
    total_tokens: number;
  };
  timestamp: string;
}

// é”™è¯¯äº‹ä»¶
interface ErrorEvent {
  type: "error";
  message: string;
  error_code?: string;
  timestamp: string;
}
```

**å“åº”ç¤ºä¾‹ï¼ˆSSEæµï¼‰**:
```
data: {"type":"thought","content":"åˆ†æç”¨æˆ·è¯·æ±‚...","step_number":1,"timestamp":"2024-01-01T00:00:00Z"}

data: {"type":"message","content":"å¥½çš„ï¼Œæˆ‘æ¥å¸®æ‚¨ç­–åˆ’ä¸€ä¸ªç°ä»£éƒ½å¸‚ç”œå® çŸ­å‰§","content_type":"text","timestamp":"2024-01-01T00:00:01Z"}

data: {"type":"done","agent_name":"ShortDramaPlannerAgent","timestamp":"2024-01-01T00:00:02Z"}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:650-730`

### 2. åˆ›ä½œåŠ©æ‰‹èŠå¤©

**æ¥å£**: `POST /juben/creator/chat`

**æè¿°**: ä¸çŸ­å‰§åˆ›ä½œåŠ©æ‰‹è¿›è¡Œå¯¹è¯

**è¯·æ±‚ä½“**: åŒä¸»èŠå¤©æ¥å£

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:735-780`

### 3. è¯„ä¼°åŠ©æ‰‹èŠå¤©

**æ¥å£**: `POST /juben/evaluation/chat`

**æè¿°**: ä¸çŸ­å‰§è¯„ä¼°åŠ©æ‰‹è¿›è¡Œå¯¹è¯

**è¯·æ±‚ä½“**: åŒä¸»èŠå¤©æ¥å£

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:785-830`

### 4. å‰§æœ¬è¯„ä¼°

**æ¥å£**: `POST /juben/script/evaluation`

**æè¿°**: æ·±åº¦å‰§æœ¬åˆ†æè¯„ä¼°

**è¯·æ±‚ä½“**:
```json
{
  "input": "å‰§æœ¬å†…å®¹...",
  "evaluation_criteria": ["ç»“æ„å®Œæ•´æ€§", "äººç‰©å¡‘é€ ", "å¯¹è¯è´¨é‡"]
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:835-880`

### 5. IPä»·å€¼è¯„ä¼°

**æ¥å£**: `POST /juben/ip/evaluation`

**æè¿°**: è¯„ä¼°IPçš„å•†ä¸šä»·å€¼å’Œå¼€å‘æ½œåŠ›

**è¯·æ±‚ä½“**:
```json
{
  "input": "IPæè¿°å†…å®¹..."
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:885-930`

### 6. æ•…äº‹äº”å…ƒç´ åˆ†æ

**æ¥å£**: `POST /juben/story-analysis/analyze`

**æè¿°**: åˆ†ææ•…äº‹çš„æ ¸å¿ƒäº”å…ƒç´ 

**è¯·æ±‚ä½“**:
```json
{
  "input": "æ•…äº‹å†…å®¹..."
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "analysis": {
    "characters": "äººç‰©åˆ†æ...",
    "plot": "æƒ…èŠ‚åˆ†æ...",
    "setting": "ç¯å¢ƒåˆ†æ...",
    "theme": "ä¸»é¢˜åˆ†æ...",
    "style": "é£æ ¼åˆ†æ..."
  }
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:935-980`

### 7. å·²æ’­å‰§é›†åˆ†æ

**æ¥å£**: `POST /juben/series-analysis/analyze`

**æè¿°**: åˆ†æå·²æ’­å‰§é›†çš„æ•°æ®å’Œè¡¨ç°

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:985-1030`

### 8. å‰§æœ¬æ·±åº¦åˆ†æ

**æ¥å£**: `POST /juben/drama/analysis`

**æè¿°**: å¯¹å‰§æœ¬è¿›è¡Œæ·±åº¦ä¸“ä¸šåˆ†æ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1035-1080`

### 9. æ•…äº‹ç±»å‹åˆ†æ

**æ¥å£**: `POST /juben/story-type/analyze`

**æè¿°**: è¯†åˆ«å’Œåˆ†ææ•…äº‹ç±»å‹

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1085-1130`

## å·¥ä½œæµæ¥å£

### 1. æƒ…èŠ‚ç‚¹å·¥ä½œæµ

**æ¥å£**: `POST /juben/plot-points-workflow/execute`

**æè¿°**: æ‰§è¡Œå®Œæ•´çš„å¤§æƒ…èŠ‚ç‚¹ä¸è¯¦ç»†æƒ…èŠ‚ç‚¹ç”Ÿæˆå·¥ä½œæµ

**è¯·æ±‚ä½“**:
```json
{
  "input": "æ•…äº‹å†…å®¹...",
  "chunk_size": 10000,
  "length_size": 50000,
  "format": "markdown"
}
```

**æµå¼å“åº”äº‹ä»¶**:
```typescript
interface WorkflowStartEvent {
  type: "workflow_start";
  message: string;
  timestamp: string;
  workflow_id: string;
}

interface AgentCompleteEvent {
  type: "agent_complete";
  message: string;
  timestamp: string;
}

interface FinalResultEvent {
  type: "final_result";
  message: string;
  timestamp: string;
  result: {
    story_summary: string;
    major_plot_points: string;
    mind_map: {
      pic: string;
      jump_link: string;
    };
    detailed_plot_points: string;
    formatted_output: string;
    metadata: {
      processing_time: string;
      chunks_processed: number;
      agents_used: string[];
      workflow_id: string;
    };
  };
}
```

**ä»£ç ä½ç½®**: `workflows/plot_points_workflow.py:82-147`

### 2. å‰§æœ¬åˆ›ä½œå·¥ä½œæµ

**æ¥å£**: `POST /juben/drama-workflow/execute`

**æè¿°**: ç«¯åˆ°ç«¯çš„å‰§æœ¬åˆ›ä½œå·¥ä½œæµ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1135-1180`

## äººç‰©ç›¸å…³æ¥å£

### 1. äººç‰©å°ä¼ ç”Ÿæˆ

**æ¥å£**: `POST /juben/character/profile`

**æè¿°**: ä¸ºæ•…äº‹ä¸­çš„ä¸»è¦äººç‰©ç”Ÿæˆè¯¦ç»†çš„äººç‰©å°ä¼ 

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1185-1230`

### 2. äººç‰©å…³ç³»åˆ†æ

**æ¥å£**: `POST /juben/character/relationship`

**æè¿°**: åˆ†ææ•…äº‹ä¸­äººç‰©ä¹‹é—´çš„å¤æ‚å…³ç³»ç½‘ç»œ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1235-1280`

## æ•…äº‹ç›¸å…³æ¥å£

### 1. æ•…äº‹å¤§çº²ç”Ÿæˆ

**æ¥å£**: `POST /juben/story/summary`

**æè¿°**: ä¸ºé•¿ç¯‡æ•…äº‹ç”Ÿæˆç²¾ç‚¼çš„æ•…äº‹å¤§çº²

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1285-1330`

### 2. å¤§æƒ…èŠ‚ç‚¹åˆ†æ

**æ¥å£**: `POST /juben/major-plot-points/chat`

**æè¿°**: åˆ†æå¹¶æå–æ•…äº‹çš„ä¸»è¦æƒ…èŠ‚ç‚¹

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1335-1380`

### 3. è¯¦ç»†æƒ…èŠ‚ç‚¹

**æ¥å£**: `POST /juben/plot-points/detailed`

**æè¿°**: å±•å¼€è¯¦ç»†çš„æƒ…èŠ‚ç‚¹å†…å®¹

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1385-1430`

### 4. æƒ…èŠ‚ç‚¹åˆ†æ

**æ¥å£**: `POST /juben/plot-points/analyze`

**æè¿°**: åˆ†æå’Œä¼˜åŒ–æ•…äº‹æƒ…èŠ‚ç‚¹çš„è®¾è®¡

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1435-1480`

### 5. æ€ç»´å¯¼å›¾ç”Ÿæˆ

**æ¥å£**: `POST /juben/mind-map/generate`

**æè¿°**: ç”Ÿæˆæ•…äº‹ç»“æ„å¯è§†åŒ–æ€ç»´å¯¼å›¾

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "result": {
    "pic": "base64_image_data",
    "jump_link": "https://example.com/mindmap"
  }
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1485-1530`

## è¯„ä¼°ç±»æ¥å£

### 1. æ•…äº‹è´¨é‡è¯„ä¼°

**æ¥å£**: `POST /juben/story/evaluation`

**æè¿°**: è¯„ä¼°æ•…äº‹çš„æ•´ä½“è´¨é‡å’Œå¸å¼•åŠ›

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1535-1580`

### 2. å¤§çº²è¯„ä¼°

**æ¥å£**: `POST /juben/outline/evaluation`

**æè¿°**: è¯„ä¼°æ•…äº‹å¤§çº²çš„å®Œæ•´æ€§å’Œå¯è¡Œæ€§

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1585-1630`

### 3. å°è¯´ç­›é€‰è¯„ä¼°

**æ¥å£**: `POST /juben/novel/screening`

**æè¿°**: è¯„ä¼°å°è¯´æ˜¯å¦é€‚åˆæ”¹ç¼–ä¸ºçŸ­å‰§

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1635-1680`

### 4. è¯„åˆ†åˆ†æ

**æ¥å£**: `POST /juben/score/analyze`

**æè¿°**: åˆ†æè¯„åˆ†æ•°æ®ï¼Œæä¾›è§£è¯»

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1685-1730`

### 5. æ–‡æœ¬å¤„ç†è¯„ä¼°

**æ¥å£**: `POST /juben/text/evaluate`

**æè¿°**: è¯„ä¼°æ–‡æœ¬å¤„ç†çš„è´¨é‡å’Œæ•ˆæœ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1735-1780`

### 6. ç»“æœåˆ†æè¯„ä¼°

**æ¥å£**: `POST /juben/result/analyze`

**æè¿°**: åˆ†æè¯„ä¼°ç»“æœï¼Œæä¾›æ´å¯Ÿ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1785-1830`

## å·¥å…·ç±»æ¥å£

### 1. ç½‘ç»œæœç´¢

**æ¥å£**: `POST /juben/websearch/chat`

**æè¿°**: å®æ—¶æœç´¢ç½‘ç»œä¿¡æ¯ï¼Œè·å–æœ€æ–°èµ„æ–™

**è¯·æ±‚ä½“**:
```json
{
  "input": "æœç´¢å…³é”®è¯",
  "count": 5,
  "language": "zh",
  "region": "cn"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "results": [
    {
      "title": "æœç´¢ç»“æœæ ‡é¢˜",
      "url": "https://example.com",
      "snippet": "ç»“æœæ‘˜è¦...",
      "source": "æ¥æºç½‘ç«™"
    }
  ],
  "total": 5
}
```

**ä»£ç ä½ç½®**: `apis/baidu/api_routes_baidu.py`

### 2. çŸ¥è¯†åº“æŸ¥è¯¢

**æ¥å£**: `POST /juben/knowledge/chat`

**æè¿°**: æŸ¥è¯¢å‰§æœ¬åˆ›ä½œçŸ¥è¯†åº“ï¼Œè·å–ä¸“ä¸šèµ„æ–™

**è¯·æ±‚ä½“**:
```json
{
  "input": "æŸ¥è¯¢å†…å®¹",
  "collection": "script_segments",
  "top_k": 5
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "results": [
    {
      "content": "çŸ¥è¯†å†…å®¹...",
      "score": 0.95,
      "metadata": {
        "source": "æ¥æº",
        "category": "åˆ†ç±»"
      }
    }
  ],
  "total": 3
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1835-1880`

### 3. æ–‡ä»¶å¼•ç”¨è§£æ

**æ¥å£**: `POST /juben/file-reference/chat`

**æè¿°**: è§£æå’Œå¼•ç”¨å¤–éƒ¨æ–‡ä»¶å†…å®¹

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1885-1930`

### 4. æ–‡æœ¬åˆ†å‰²

**æ¥å£**: `POST /juben/text/split`

**æè¿°**: æ™ºèƒ½åˆ†å‰²é•¿æ–‡æœ¬ä¸ºåˆé€‚çš„æ®µè½

**è¯·æ±‚ä½“**:
```json
{
  "input": "é•¿æ–‡æœ¬å†…å®¹...",
  "chunk_size": 10000
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1935-1980`

### 5. æ–‡æœ¬æˆªæ–­

**æ¥å£**: `POST /juben/text/truncate`

**æè¿°**: æŒ‰è¦æ±‚æˆªæ–­æ–‡æœ¬å¹¶ä¿æŒå®Œæ•´æ€§

**è¯·æ±‚ä½“**:
```json
{
  "input": "é•¿æ–‡æœ¬å†…å®¹...",
  "max_length": 50000
}
```

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:1985-2030`

### 6. æ–‡æ¡£ç”Ÿæˆ

**æ¥å£**: `POST /juben/document/generate`

**æè¿°**: ç”Ÿæˆæ ‡å‡†åŒ–çš„å‰§æœ¬æ–‡æ¡£

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:2035-2080`

### 7. è¾“å‡ºæ ¼å¼åŒ–

**æ¥å£**: `POST /juben/output/format`

**æè¿°**: æ ¼å¼åŒ–AIè¾“å‡ºï¼Œç¡®ä¿ç¬¦åˆè§„èŒƒ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:2085-2130`

### 8. ç»“æœé›†æˆ

**æ¥å£**: `POST /juben/result/integrate`

**æè¿°**: é›†æˆå¤šä¸ªAgentçš„ç»“æœ

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:2135-2180`

### 9. å‰§é›†ä¿¡æ¯æå–

**æ¥å£**: `POST /juben/series/info`

**æè¿°**: ä»æ–‡æœ¬ä¸­æå–å‰§é›†ç›¸å…³ä¿¡æ¯

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:2185-2230`

### 10. å‰§åæå–

**æ¥å£**: `POST /juben/series/name`

**æè¿°**: æ™ºèƒ½è¯†åˆ«å’Œæå–çŸ­å‰§åç§°

**ä»£ç ä½ç½®**: `apis/core/api_routes.py:2235-2280`

## é¡¹ç›®ç®¡ç†æ¥å£

### 1. åˆ›å»ºé¡¹ç›®

**æ¥å£**: `POST /juben/projects`

**æè¿°**: åˆ›å»ºæ–°é¡¹ç›®

**è¯·æ±‚ä½“**:
```json
{
  "name": "é¡¹ç›®åç§°",
  "description": "é¡¹ç›®æè¿°",
  "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"],
  "metadata": {}
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "project": {
    "id": "uuid",
    "name": "é¡¹ç›®åç§°",
    "description": "é¡¹ç›®æè¿°",
    "user_id": "user123",
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z",
    "status": "active",
    "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"],
    "file_count": 0
  }
}
```

**ä»£ç ä½ç½®**: `apis/projects/api_routes_projects.py`

### 2. è·å–é¡¹ç›®åˆ—è¡¨

**æ¥å£**: `GET /juben/projects`

**æè¿°**: è·å–ç”¨æˆ·çš„é¡¹ç›®åˆ—è¡¨

**è¯·æ±‚å‚æ•°**:

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| page | number | å¦ | é¡µç ï¼ˆé»˜è®¤: 1ï¼‰ |
| page_size | number | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤: 20ï¼‰ |
| status | string | å¦ | çŠ¶æ€ç­›é€‰ |
| tags | string | å¦ | æ ‡ç­¾ç­›é€‰ï¼ˆé€—å·åˆ†éš”ï¼‰ |

### 3. è·å–é¡¹ç›®è¯¦æƒ…

**æ¥å£**: `GET /juben/projects/{project_id}`

**æè¿°**: è·å–é¡¹ç›®è¯¦æƒ…å’Œæ–‡ä»¶åˆ—è¡¨

### 4. æ›´æ–°é¡¹ç›®

**æ¥å£**: `PATCH /juben/projects/{project_id}`

**æè¿°**: æ›´æ–°é¡¹ç›®ä¿¡æ¯

### 5. åˆ é™¤é¡¹ç›®

**æ¥å£**: `DELETE /juben/projects/{project_id}`

**æè¿°**: åˆ é™¤é¡¹ç›®ï¼ˆè½¯åˆ é™¤ï¼‰

### 6. æ·»åŠ é¡¹ç›®æ–‡ä»¶

**æ¥å£**: `POST /juben/projects/{project_id}/files`

**æè¿°**: å‘é¡¹ç›®æ·»åŠ æ–‡ä»¶

**è¯·æ±‚ä½“**:
```json
{
  "filename": "ç­–åˆ’æ–¹æ¡ˆ.md",
  "file_type": "drama_planning",
  "content": "æ–‡ä»¶å†…å®¹...",
  "agent_source": "short_drama_planner",
  "tags": ["ç­–åˆ’"]
}
```

### 7. å¯¼å‡ºé¡¹ç›®

**æ¥å£**: `POST /juben/projects/{project_id}/export`

**æè¿°**: å¯¼å‡ºé¡¹ç›®åŠæ–‡ä»¶

**è¯·æ±‚ä½“**:
```json
{
  "format": "json",
  "include_files": true,
  "file_types": ["script", "plot_points"]
}
```

## ç³»ç»Ÿæ¥å£

### 1. å¥åº·æ£€æŸ¥

**æ¥å£**: `GET /health`

**æè¿°**: æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "healthy",
  "service": "å‰§æœ¬åˆ›ä½œ Agent å¹³å°",
  "version": "1.0.0",
  "agents_count": 40
}
```

**ä»£ç ä½ç½®**: `main.py:59-67`

### 2. è·å–æ¨¡å‹åˆ—è¡¨

**æ¥å£**: `GET /juben/models`

**æè¿°**: è·å–å¯ç”¨çš„LLMæ¨¡å‹åˆ—è¡¨

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "models": [
    {
      "id": "glm-4-flash",
      "name": "æ™ºè°±GLM-4-Flash",
      "provider": "zhipu",
      "description": "å…è´¹å¿«é€Ÿæ¨¡å‹",
      "context_length": 128000
    },
    {
      "id": "glm-4.7-flash",
      "name": "æ™ºè°±GLM-4.7-Flash",
      "provider": "zhipu",
      "description": "å…è´¹é«˜æ€§èƒ½æ¨¡å‹",
      "context_length": 128000
    }
  ]
}
```

### 3. è·å–ç³»ç»Ÿé…ç½®

**æ¥å£**: `GET /juben/config`

**æè¿°**: è·å–ç³»ç»Ÿé…ç½®ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "config": {
    "enable_web_search": true,
    "enable_knowledge_base": true,
    "max_history_length": 50,
    "default_model": "glm-4-flash",
    "supported_formats": ["json", "markdown", "txt"]
  }
}
```

### 4. è·å–ç»Ÿè®¡ä¿¡æ¯

**æ¥å£**: `GET /juben/stats`

**æè¿°**: è·å–ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "total_sessions": 1000,
  "total_messages": 50000,
  "active_agents": 35,
  "avg_response_time": 2.5,
  "system_uptime": 86400
}
```

## APIæ¥å£æ€»è§ˆ

| æ¨¡å— | æ¥å£æ•° | è¯´æ˜ |
|------|--------|------|
| Agentç®¡ç† | 4 | Agentåˆ—è¡¨ã€è¯¦æƒ…ã€åˆ†ç±»ã€æœç´¢ |
| èŠå¤©äº¤äº’ | 9 | ä¸»èŠå¤©ã€åˆ›ä½œã€è¯„ä¼°ã€åˆ†æç­‰ |
| å·¥ä½œæµ | 2 | æƒ…èŠ‚ç‚¹å·¥ä½œæµã€å‰§æœ¬åˆ›ä½œå·¥ä½œæµ |
| äººç‰©ç›¸å…³ | 2 | äººç‰©å°ä¼ ã€äººç‰©å…³ç³» |
| æ•…äº‹ç›¸å…³ | 5 | å¤§çº²ã€æƒ…èŠ‚ç‚¹ã€æ€ç»´å¯¼å›¾ç­‰ |
| è¯„ä¼°ç±» | 6 | è´¨é‡è¯„ä¼°ã€è¯„åˆ†åˆ†æç­‰ |
| å·¥å…·ç±» | 10 | æœç´¢ã€çŸ¥è¯†åº“ã€æ–‡ä»¶å¤„ç†ç­‰ |
| é¡¹ç›®ç®¡ç† | 7 | é¡¹ç›®CRUDã€æ–‡ä»¶ç®¡ç†ã€å¯¼å‡º |
| ç³»ç»Ÿæ¥å£ | 4 | å¥åº·æ£€æŸ¥ã€é…ç½®ã€ç»Ÿè®¡ |

**æ€»è®¡**: 49ä¸ªAPIæ¥å£

## ç›¸å…³æ–‡æ¡£

- [é¢†åŸŸæ¨¡å‹è¯´æ˜](./é¢†åŸŸæ¨¡å‹è¯´æ˜.md) - æ•°æ®æ¨¡å‹è¯´æ˜
- [ä¸šåŠ¡æµç¨‹è¯´æ˜](./ä¸šåŠ¡æµç¨‹è¯´æ˜.md) - ä¸šåŠ¡æµç¨‹è¯¦è§£
- [å¤–éƒ¨ä¾èµ–è¯´æ˜](./å¤–éƒ¨ä¾èµ–è¯´æ˜.md) - å¤–éƒ¨æœåŠ¡è¯´æ˜
